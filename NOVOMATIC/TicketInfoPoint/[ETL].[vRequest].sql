/*
Template NIS (1.1 - 2015-04-01) 

????   ??? ??????? ???   ??? ??????? ????   ???? ?????? ???????????? ???????
?????  ???????????????   ????????????????? ?????????????????????????????????
?????? ??????   ??????   ??????   ??????????????????????   ???   ??????     
?????????????   ??????? ???????   ??????????????????????   ???   ??????     
??? ??????????????? ??????? ???????????? ??? ??????  ???   ???   ???????????
???  ????? ???????   ?????   ??????? ???     ??????  ???   ???   ??? ???????
                                                                            
Author..............: Fabio De Stefani
Creation Date.......: 2017-09-07 
Description.........: Concessionary

Revision			 

Note
- Use [Tab size] = 3 and [Indent size] = 3 (Insert space) 

SELECT * FROM ETL.vRequest WHERE TicketID = '690296629039549'
*/
ALTER VIEW [ETL].[vRequest]
AS
SELECT	DISTINCT        
		 R.requestId
		,R.requestDesc
		,R.requestClaimantId
		,C.requestClaimantName
		,R.elabStart
		,R.elabEnd
		,R.requestStatusId
		,RS.requestStatusDesc AS requestStatusDesc
		,R.system_date
		,R.ConcessionaryID
		,VC.ConcessionaryName
		,R.ClubID
		,R.FilterAmount
		,R.FilterStartDate
		,R.FilterEndDate
		,RD.ticket AS TicketID
FROM	ETL.request R WITH(NOLOCK) 
		INNER JOIN
        ETL.requestClaimant C WITH(NOLOCK) 
		ON R.requestClaimantId = C.requestClaimantId 
		INNER JOIN
        ETL.requestStatus RS WITH(NOLOCK) 
		ON R.requestStatusId = RS.requestStatusId 
		INNER JOIN
        ETL.vConcessionary VC WITH(NOLOCK) 
		ON R.ConcessionaryID = VC.ConcessionarySK
		LEFT JOIN
		ETL.requestDetail RD WITH(NOLOCK)
		ON R.requestId = RD.requestId
GO


